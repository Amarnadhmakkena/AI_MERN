const r=require('express').Router(),u=require('../models/User'),b=require('bcryptjs'),j=require('jsonwebtoken');r.post('/signup',async(req,res)=>{const h=await b.hash(req.body.password,10);await u.create({username:req.body.username,password:h});res.json('ok')});r.post('/login',async(req,res)=>{const x=await u.findOne({username:req.body.username});if(!x)return res.status(400).end();if(!await b.compare(req.body.password,x.password))return res.status(400).end();res.json({token:j.sign({id:x._id},process.env.JWT_SECRET)});});module.exports=r;